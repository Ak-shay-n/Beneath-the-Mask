<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Company login</title>
    <meta name="description" content="Company login page created by Nadeem" />

    <!-- Pico.css -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/@picocss/pico@1.*/css/pico.min.css"
    />

    <style>
      /* Grid */
      body {
        background-image: url(/static/img/image.png);
        background-size: 100%;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        height: 100%;
        width: 100%;
        overflow: hidden;
      }

      h6 {
        text-align: left;
      }

      article {
        text-align: center;
      }

      article {
        padding: 0;
        overflow: hidden;
        width: 800px;
        height: 650px;
        justify-content: center;
      }

      body > main {
        display: flex;
        flex-direction: row;
        justify-content: center;
        position: relative;
        top: -75px;
        min-height: calc(100vh - 7rem);
        opacity: 80%;
      }

      .alert.error {
        padding: 5px;
        border-radius: 2px;
        font-size: 1.2rem;
        margin-bottom: 10px;
        border: 2px solid darkred;
        background-color: red;
        color: white;
      }

      .alert.success {
        padding: 5px;
        border-radius: 2px;
        font-size: 1.2rem;
        margin-bottom: 10px;
        border: 2px solid orange;
        background-color: yellow;
        color: black;
      }

      html {
        zoom: 75%;
      }

      @media (min-width: 1200px) {
        article div {
          padding: 50px;
          justify-content: center;
        }
      }

      /* Intro Dialogue Styles */
      #intro-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(3px);
        z-index: 9999;
        display: flex;
        align-items: flex-end;
        justify-content: flex-start;
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      .intro-container {
        display: flex;
        align-items: center;
        gap: 20px;
        padding: 20px;
        position: relative;
        margin-bottom: 100px;
      }

      .character-image {
        width: 280px;
        height: 280px;
        background: url('/static/img/jk.png') no-repeat center;
        background-size: contain;
        animation: popupFromLeft 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        flex-shrink: 0;
        border-radius: 10px;
      }

      @keyframes popupFromLeft {
        0% {
          transform: translateX(-150px) scale(0.5);
          opacity: 0;
        }
        60% {
          transform: translateX(10px) scale(1.05);
        }
        100% {
          transform: translateX(0) scale(1);
          opacity: 1;
        }
      }

      .dialogue-box {
        background: linear-gradient(180deg, #ffffff 0%, #e6f2ff 100%);
        border-radius: 35px;
        padding: 30px 40px;
        position: relative;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 2px solid #d0e6ff;
        min-height: 140px;
        max-width: 600px;
        margin-bottom: 20px;
      }

      .dialogue-box.slide-in {
        animation: slideFromImage 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      @keyframes cloudAppear {
        from {
          transform: scale(0.8);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes slideFromImage {
        from {
          transform: translate(-280px, 80px) scale(0.3);
          opacity: 0;
        }
        to {
          transform: translate(0, 0) scale(1);
          opacity: 1;
        }
      }

      /* Speech bubble tail pointing to character */
      .dialogue-box::before {
        content: '';
        position: absolute;
        left: -12px;
        top: 45%;
        width: 30px;
        height: 30px;
        background: #e6f2ff;
        border-radius: 50%;
        border-left: 2px solid #d0e6ff;
        border-top: 2px solid #d0e6ff;
        box-shadow: -2px -2px 5px rgba(0, 0, 0, 0.05);
        z-index: 10;
      }

      .dialogue-box::after {
        content: '';
        position: absolute;
        left: -25px;
        top: 50%;
        width: 20px;
        height: 20px;
        background: #ffffff;
        border-radius: 50%;
        border: 2px solid #d0e6ff;
        box-shadow: -2px -2px 5px rgba(0, 0, 0, 0.05);
        z-index: 5;
      }

      .dialogue-header {
        padding: 0 0 12px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        margin-bottom: 15px;
        text-align: left;
      }

      .dialogue-header h2 {
        margin: 0;
        color: #333;
        font-size: 1.3rem;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      .dialogue-text {
        color: #000;
        font-size: 1.1rem;
        line-height: 1.6;
        font-weight: 400;
        min-height: 80px;
        display: flex;
        align-items: center;
      }

      .dialogue-text p {
        margin: 0;
      }

      .dialogue-controls {
        margin-top: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .continue-hint {
        color: #888;
        font-size: 0.8rem;
        font-style: italic;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
      }

      .skip-button {
        background: rgba(0, 0, 0, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 6px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.8rem;
        transition: all 0.2s;
      }

      .skip-button:hover {
        background: rgba(0, 0, 0, 0.85);
        transform: translateY(-1px);
      }

      .typing-cursor {
        display: inline-block;
        width: 2px;
        height: 18px;
        background-color: #000;
        margin-left: 2px;
        animation: blink 0.7s infinite;
      }

      @keyframes blink {
        0%, 49% { opacity: 1; }
        50%, 100% { opacity: 0; }
      }

      .progress-indicator {
        text-align: center;
        margin-top: 12px;
        color: #999;
        font-size: 0.75rem;
      }

      .progress-dots {
        display: flex;
        gap: 6px;
        justify-content: center;
        margin-top: 8px;
      }

      .progress-dot {
        width: 7px;
        height: 7px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.15);
        transition: all 0.3s;
      }

      .progress-dot.active {
        background: #555;
        transform: scale(1.2);
      }

      .progress-dot.completed {
        background: #888;
      }

      /* Replay Tutorial Button */
      #replay-tutorial-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.7);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s;
        z-index: 1000;
        backdrop-filter: blur(5px);
      }

      #replay-tutorial-btn:hover {
        background: rgba(0, 0, 0, 0.9);
        border-color: rgba(255, 255, 255, 0.6);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
      }

      #replay-tutorial-btn.hidden {
        display: none;
      }
    </style>
  </head>

  <body>
    <!-- Replay Tutorial Button -->
    <button id="replay-tutorial-btn" class="hidden">ðŸŽ¬ Replay Tutorial</button>

    <!-- Intro Dialogue Overlay -->
    <div id="intro-overlay">
      <div class="intro-container">
        <div class="character-image"></div>
        <div class="dialogue-box">
          <div class="dialogue-header">
            <h2>Mission Briefing</h2>
          </div>
          <div class="dialogue-text">
            <p id="dialogue-content" style="color : #000"></p>
          </div>
          <div class="progress-indicator">
            <div class="progress-dots" id="progress-dots"></div>
          </div>
          <div class="dialogue-controls">
            <span class="continue-hint" id="continue-hint">Click or press Space to continue...</span>
          </div>
        </div>
      </div>
    </div>

    <nav class="container-fluid">
      <ul>
        <li>
          <a href="./" class="contrast"><strong>Company Login</strong></a>
        </li>
      </ul>
    </nav>
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %}
    <div class="alert {{ category }}">{{ message|capitalize }}</div>
    {% endfor %} {% endif %} {% endwith %}

    <main class="container">
      <article class="badge-primary">
        <div>
          <hgroup>
            <h1>Event Attendance</h1>
            <h2>Enter your details here</h2>
          </hgroup>
          <form method="POST">
            <h6>
              Enter Your Fullname<strong>[For Certification Purpose]</strong>
            </h6>
            <input
              type="text"
              id="username"
              name="username"
              placeholder="Name"
              aria-label="username"
              autocomplete="nickname"
              required
            />
            <h6>Enter Your College Name</h6>
            <input
              type="text"
              id="teamname"
              name="teamname"
              placeholder="Name"
              aria-label="teamname"
              autocomplete="nickname"
              required
            />
            <button id="submit" type="submit" class="contrast">Login</button>
          </form>
        </div>
      </article>
    </main>

    <script>
      // Dialogue script broken into messages
      const dialogueScript = [
        "Hey guys,",
        "REVIL here. Welcome to the Beneath The Mask Event, Revil 2026.",
        "In this event, you are a detective who is assigned a very serious case about a masked killer.",
        "Now you have entered the suspect's house and gained access to his computer. He is out of town, but he will return in 45 minutes.",
        "The suspect is a masked killer, and it is your job to uncover who is behind the mask and why.",
        "You must go through the suspect's computer and find the password needed to gain access, in order to reveal his past and motive before time runs out."
      ];

      let currentMessageIndex = 0;

      // Initialize progress dots
      function initProgressDots() {
        const dotsContainer = document.getElementById('progress-dots');
        dialogueScript.forEach((_, index) => {
          const dot = document.createElement('div');
          dot.className = 'progress-dot';
          dot.id = `dot-${index}`;
          dotsContainer.appendChild(dot);
        });
      }

      // Update progress dots
      function updateProgressDots() {
        dialogueScript.forEach((_, index) => {
          const dot = document.getElementById(`dot-${index}`);
          if (index < currentMessageIndex) {
            dot.className = 'progress-dot completed';
          } else if (index === currentMessageIndex) {
            dot.className = 'progress-dot active';
          } else {
            dot.className = 'progress-dot';
          }
        });
      } 

      // Display current message
      function showMessage() {
        if (currentMessageIndex >= dialogueScript.length) {
          endIntro();
          return;
        }

        updateProgressDots();
        const message = dialogueScript[currentMessageIndex];
        const contentElement = document.getElementById('dialogue-content');
        const dialogueBox = document.querySelector('.dialogue-box');
        
        // Remove animation class
        dialogueBox.classList.remove('slide-in');
        
        // Trigger reflow to restart animation
        void dialogueBox.offsetWidth;
        
        // Add animation class and update content
        dialogueBox.classList.add('slide-in');
        contentElement.innerHTML = message;
      }

      // Handle next message
      function nextMessage() {
        currentMessageIndex++;
        showMessage();
      }

      // Skip the entire intro
      function skipIntro() {
        localStorage.setItem('intro-seen', 'true');
        endIntro();
      }

      // End intro and show main content
      function endIntro() {
        const overlay = document.getElementById('intro-overlay');
        const replayBtn = document.getElementById('replay-tutorial-btn');
        overlay.style.animation = 'fadeOut 0.5s ease-out';
        
        setTimeout(() => {
          overlay.style.display = 'none';
          localStorage.setItem('intro-seen', 'true');
          replayBtn.classList.remove('hidden');
        }, 500);
      }

      // Replay tutorial function
      function replayTutorial() {
        const overlay = document.getElementById('intro-overlay');
        const replayBtn = document.getElementById('replay-tutorial-btn');
        
        // Reset state
        currentMessageIndex = 0;
        replayBtn.classList.add('hidden');
        
        // Show overlay
        overlay.style.display = 'flex';
        overlay.style.animation = 'fadeIn 0.5s ease-in';
        
        // Reset and show first message
        const dotsContainer = document.getElementById('progress-dots');
        dotsContainer.innerHTML = '';
        initProgressDots();
        showMessage();
      }

      // Add fadeOut animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes fadeOut {
          from { opacity: 1; }
          to { opacity: 0; }
        }
      `;
      document.head.appendChild(style);

      // Event listeners
      document.addEventListener('DOMContentLoaded', () => {
        const replayBtn = document.getElementById('replay-tutorial-btn');
        
        // Check if intro has been seen
        if (localStorage.getItem('intro-seen') === 'true') {
          document.getElementById('intro-overlay').style.display = 'none';
          replayBtn.classList.remove('hidden');
          return;
        }

        initProgressDots();
        showMessage();

        // Replay button click
        replayBtn.addEventListener('click', replayTutorial);

        // Click to continue
        document.getElementById('intro-overlay').addEventListener('click', (e) => {
          if (!e.target.classList.contains('skip-button')) {
            nextMessage();
          }
        });

        // Space bar to continue
        document.addEventListener('keydown', (e) => {
          if (e.code === 'Space' && document.getElementById('intro-overlay').style.display !== 'none') {
            e.preventDefault();
            nextMessage();
          }
        });
      });
    </script>
  </body>
</html>
